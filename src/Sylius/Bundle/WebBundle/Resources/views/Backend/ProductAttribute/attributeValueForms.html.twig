{% for attributeId, form in forms %}
    <div class="form-group">
        <label class="col-lg-2 control-label required" for="sylius_product_attributes_{{ count }}_attribute">{{ form_label(form) }}</label>
        <input type="hidden" name="sylius_product[attributes][{{ count }}][attribute]" id="sylius_product_attributes_{{ count }}_attribute" value="{{ attributeId }}"/>
        <div class="col-lg-10">
            {{ _self.formField(form, count) }}
        </div>
    </div>
    {% set count = count+1 %}
{% endfor %}

{% macro formField(item, count, prefix = '') %}
    {% if item.children|length > 0 %}
        {% set prefix = prefix~'_'~item.vars.name %}
        {% for child in item.children %}
            {{ _self.formField(child, count, prefix) }}
        {% endfor %}
    {% elseif item.vars.name != '_token' %}
        {% set namePrefix = prefix|replace({'_': ']['}) %}
        {% set id = 'sylius_product_attributes_'~count~prefix~'_'~item.vars.name %}
        {% set dataName = 'sylius_product[attributes]['~count~namePrefix~']['~item.vars.name~']' %}

        {{ form_widget(item, {'attr': {'id': id, 'data-name': dataName }}) }}
    {% endif %}
{% endmacro %}
